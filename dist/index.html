<html><head>
    <!-- <link type="text/css" rel="stylesheet" href="google-sheet.css"> -->
    <link type="text/css" rel="stylesheet" href="custom.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
</head>

<body>
    <div class="grid">
        <nav><a href="#File-Types">File Types</a><a href="#Commands">Commands</a></nav>
        <article><section id="File-Types">
    <h1>File Types</h1>
    <figure><table class="" cellspacing="0" cellpadding="0"><tbody><tr class=""><td class="">File Type</td><td class="">Description</td><td class="">Think of</td><td class="">Common Extensions</td><td class="">Wiki Page</td><td class="">Identification Method</td><td class=""><div class="softmerge-inner" style="width:52px;left:-1px">File type</div></td><td class="">Contains</td><td class=""><div class="softmerge-inner" style="width:62px;left:-1px">Encrypted</div></td><td class="">Sensitive</td><td class="">Notes</td></tr><tr class=""><td class="">PKCS12/PFX</td><td class=""><div class="softmerge-inner" style="width:166px;left:-1px">PKCS#12 Certificate Bundle</div></td><td class="">A binary blob of multiple certs and keys</td><td class="">.p12 .pfx</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/PKCS_12">https://en.wikipedia.org/wiki/PKCS_12</a></td><td class="">file command: data, openssl verify</td><td class="">BINARY</td><td class="">Key(s), Cert(s)</td><td class="">Yes</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">PEM</td><td class="">X.509 Bundle</td><td class="">Base64-encode&nbsp;1+&nbsp;DER's with headers</td><td class="">.pem</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail">https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail</a></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN</span></td><td class="">ASCII</td><td class=""><div class="softmerge-inner" style="width:158px;left:-1px">Key(s), Cert(s), Request(s)</div></td><td class="">Maybe</td><td class="">Sometimes</td><td class=""><div class="softmerge-inner" style="width:536px;left:-1px">PEM(1x) = PEM with one key or cert; PEM(Nx) = PEM with one or more keys or certs</div></td></tr><tr class=""><td class="">DER</td><td class="">DER-encoded Certificate</td><td class="">A binary blob with actual data</td><td class="">.der .cer .crt .cert .pem</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/X.690#DER_encoding">https://en.wikipedia.org/wiki/X.690#DER_encoding</a></td><td class="">file command: data, openssl verify </td><td class="">BINARY</td><td class="">Key OR Cert OR Request</td><td class="">No</td><td class="">Sometimes</td><td class=""></td></tr><tr class=""><td class="">P7B</td><td class="">PKCS#7 Certificate</td><td class="">Certs for sharing/recognizing</td><td class="">.p7b</td><td class=""></td><td class="">???</td><td class=""></td><td class="">Cert(s)</td><td class="">No</td><td class="">Sometimes</td><td class=""></td></tr><tr class=""><td class="">CRL</td><td class="">Certificate Revocation List</td><td class="">Telling everyone a cert is no longer good</td><td class="">.crl</td><td class=""></td><td class="">???</td><td class=""></td><td class="">Revocation(s)</td><td class=""></td><td class="">No</td><td class=""></td></tr><tr class=""><td class="">'CSR'</td><td class=""><div class="softmerge-inner" style="width:166px;left:-1px">Certificate Signing Request</div></td><td class=""><div class="softmerge-inner" style="width:337px;left:-1px">Typically&nbsp;a PEM with just a request and named differently!</div></td><td class="">.csr</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN CERTIFICATE REQUEST-----</span></td><td class="">ASCII</td><td class="">Request (but any PEM)</td><td class="">Maybe</td><td class="">If misnamed</td><td class=""></td></tr><tr class=""><td class="">'KEY'</td><td class="">Key</td><td class="">Typically a PEM with just a key and named differently!</td><td class="">.key .rsa</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN </span>and <span style="font-family:Courier New;">KEY-----</span></td><td class="">ASCII</td><td class="">Key (but any PEM)</td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">CERT'</td><td class="">Certificate</td><td class=""><div class="softmerge-inner" style="width:337px;left:-1px">Typically&nbsp;a PEM with just a cert and named differently!</div></td><td class="">.cert</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN CERTIFICATE-----</span></td><td class="">ASCII</td><td class="">Cert (but any PEM)</td><td class="">Maybe</td><td class="">If misnamed</td><td class=""></td></tr><tr class=""><td class="">JKS</td><td class="">Java KeyStore</td><td class="">A binary blob of multiple certs and keys</td><td class="">.jks .keystore .truststore </td><td class=""></td><td class="">???</td><td class="">BINARY</td><td class=""></td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">BKS</td><td class="">BouncyCastle KeyStore</td><td class="">A binary blob of multiple certs and keys</td><td class="">.bks</td><td class=""><a target="_blank" href="http://www.bouncycastle.org/specifications.html">http://www.bouncycastle.org/specifications.html</a></td><td class="">???</td><td class="">BINARY</td><td class=""></td><td class=""></td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">PPK</td><td class="">Putty Key File</td><td class="">A PuTTY-specific format for Private keys</td><td class="">.ppk</td><td class=""><div class="softmerge-inner" style="width:424px;left:-1px"><a target="_blank" href="https://the.earth.li/~sgtatham/putty/0.76/htmldoc/AppendixC.html#ppk">https://the.earth.li/~sgtatham/putty/0.76/htmldoc/AppendixC.html#ppk</a></div></td><td class="">???</td><td class="">ASCII</td><td class="">Public and Private Key</td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr></tbody></table></figure>
</section><section id="Commands">
    <h1>Commands</h1>
    <figure><table class="" cellspacing="0" cellpadding="0"><tbody><tr class=""><td class="" colspan="2">Tools</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">Name</td><td class="">Executable</td><td class="">Developer</td><td class="">Notes</td></tr><tr class=""><td class="">OpenSSL</td><td class="">openssl</td><td class=""></td><td class="">Jack-of-all-trades Toolbox - can handle MOST tasks</td></tr><tr class=""><td class="">Java Keytool</td><td class="">keytool</td><td class="">Oracle/OpenJDK</td><td class="">Was prominent when Java KeyStores were popular; largely OBE</td></tr><tr class=""><td class="">SSH Keygen</td><td class="">ssh-keygen</td><td class=""></td><td class="">A popular wrapper to quickly and easily create ssh keys</td></tr><tr class=""><td class="">PuTTYGen</td><td class="">puttygen</td><td class=""></td><td class="">The Windows version cannot use cli flags; only the Linux package can</td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Between Formats</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">From</td><td class="">To</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">DER</td><td class="">Convert</td><td class="">openssl x509 -inform PEM -in <span style="font-weight:bold;">in.pem</span> -outform DER -out <span style="font-weight:bold;">out.der</span></td></tr><tr class=""><td class="">DER</td><td class="">PEM(1x)</td><td class="">Convert</td><td class="">openssl x509 -inform DER -in <span style="font-weight:bold;">in.der</span> -outform PEM -out <span style="font-weight:bold;">out.pem</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Export from Bundle</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">From</td><td class="">To</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="" rowspan="3">PEM(1x)</td><td class="">Export via Split</td><td class="">Use a text editor and save a new file</td></tr><tr class=""><td class="">Cert-only csplit</td><td class="">csplit --prefix='cert.' --suffix-format='%03d.pem' <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'</td></tr><tr class=""><td class=""><a target="_blank" href="https://gist.github.com/jinnko/d6867ce326e8b6e88975">AWK Script</a></td><td class="">Handy AWK Script</td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">DER</td><td class="">Export via Split</td><td class="">PEM -&gt; PEM(1x) -&gt; DER</td></tr><tr class=""><td class="">P12</td><td class="">PEM(1x)</td><td class="">Export</td><td class="">P12 -&gt; PEM -&gt; PEM(1x)</td></tr><tr class=""><td class="">P12</td><td class="">DER</td><td class="">Export</td><td class="">keytool -export -alias <span style="font-weight:bold;">alias</span> -file <span style="font-weight:bold;">out.der</span> -keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="">JKS</td><td class="">PEM(1x)</td><td class="">Export</td><td class="">JKS -&gt; P12 -&gt; PEM -&gt; PEM(1x)</td></tr><tr class=""><td class="">JKS</td><td class="">DER</td><td class="">Export</td><td class="">keytool -export -alias <span style="font-weight:bold;">alias</span> -file&nbsp;<span style="font-weight:bold;">out.der</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Import to Bundle</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">From</td><td class="">To</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">PEM(Nx)</td><td class="">Import via Merge</td><td class="">cat <span style="font-weight:bold;">1.pem</span> &gt;&gt; <span style="font-weight:bold;">2.pem</span></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">P12</td><td class="">Import Cert and Key</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">certificate.p12</span> -inkey <span style="font-weight:bold;">inkey.pem</span> -in <span style="font-weight:bold;">incert.pem</span> -certfile<span style="font-weight:bold;"> CACert.pem</span></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">JKS</td><td class="">Import</td><td class="">PEM(1x) -&gt; DER -&gt; JKS</td></tr><tr class=""><td class="">DER</td><td class="">PEM(Nx)</td><td class="">Import</td><td class="">DER -&gt; PEM(1x) -&gt; PEM</td></tr><tr class=""><td class="">DER</td><td class="">P12</td><td class="">Import</td><td class="">DER -&gt; PEM(1x) -&gt; P12</td></tr><tr class=""><td class="">DER</td><td class="">JKS</td><td class="">Import</td><td class="">keytool -import -alias <span style="font-weight:bold;">alias</span> -keystore <span style="font-weight:bold;">store.jks</span> -file <span style="font-weight:bold;">in.der</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Between Bundles</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">From</td><td class="">To</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">store.p12</span> -in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">newstore.p12 </span>-in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Build a full-chain P12</td><td class="">cat <span style="font-weight:bold;">cacerts.pem cert.pem</span> &gt;&gt; <span style="font-weight:bold;">merged.pem<br></span>openssl pkcs12 -export -inkey <span style="font-weight:bold;">key.pem</span> -in <span style="font-weight:bold;">merged.pem </span>-name <span style="font-weight:bold;">myname </span>-out <span style="font-weight:bold;">mergedWithKey.pem</span></td></tr><tr class=""><td class="" rowspan="2">PEM(Nx)</td><td class="" rowspan="2">JKS</td><td class="">Convert</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="">Import to Existing</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="" rowspan="2">P12</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 -out <span style="font-weight:bold;">newstore.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 &gt;&gt; <span style="font-weight:bold;">store.pem</span></td></tr><tr class=""><td class="" rowspan="3">P12</td><td class="" rowspan="3">JKS</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">newstore.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import All to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -srcalias <span style="font-weight:bold;">alias</span>&nbsp;-destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="" rowspan="3">JKS</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks</span> -srcstoretype JKS -destkeystore <span style="font-weight:bold;">newstore.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import All&nbsp;to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in</span>.<span style="font-weight:bold;">jks </span>-srcstoretype JKS -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import&nbsp;One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks </span>-srcstoretype JKS -srcalias <span style="font-weight:bold;">alias</span> -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="" rowspan="2">JKS</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">JKS -&gt; P12 -&gt; PEM</td></tr><tr class=""><td class="">Import to Existing</td><td class="">JKS -&gt;&nbsp;P12 -&gt; PEM</td></tr><tr class=""><td class="" rowspan="2">PPK</td><td class="" rowspan="2">PEM(1x)</td><td class="">Extract Public Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">cert.pem</span> -O public</td></tr><tr class=""><td class="">Extract Private Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">key.pem </span>-O private-openssh</td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">PPK</td><td class="">Convert</td><td class="">puttygen <span style="font-weight:bold;">inkey.pem</span> -o <span style="font-weight:bold;">out.ppk </span>-O private</td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Create Bundle</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">P12</td><td class="">Generate/Create<br>Delete</td><td class="">keytool -genkey -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.p12</span><br>keytool -delete -alias<span style="font-weight:bold;"> tem</span>p -keystore<span style="font-weight:bold;"> stor</span>e<span style="font-weight:bold;">.p12</span></td></tr><tr class=""><td class="" colspan="2">JKS</td><td class="">Generate/Create<br>Delete</td><td class="">keytool -genkey -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span><br>keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="" colspan="2">PEM (1x or Nx)</td><td class="">Create</td><td class="">touch <span style="font-weight:bold;">store.pem</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">List Bundle Contents</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">P12</td><td class="">List</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.p12</span>  <br>OR<br>openssl pkcs12 -info -i<span style="font-weight:bold;">n sto</span>re<span style="font-weight:bold;">.p12</span></td></tr><tr class=""><td class="" colspan="2">JKS</td><td class="">List</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="" colspan="2" rowspan="2">PEM(1x)</td><td class="">List Key</td><td class="">openssl rsa -in <span style="font-weight:bold;">store.pem</span> -check</td></tr><tr class=""><td class="">List Cert</td><td class="">openssl x509 -in <span style="font-weight:bold;">store.pem</span> -text</td></tr><tr class=""><td class="" colspan="2" rowspan="3">PEM(Nx)</td><td class="">List Cert Subjects/Issuers</td><td class="">openssl crl2pkcs7 -nocrl -certfile CHAINED.pem | openssl pkcs7 -print_certs -noout</td></tr><tr class=""><td class="">List Cert Details</td><td class="">openssl crl2pkcs7 -nocrl -certfile CHAINED.pem | openssl pkcs7 -print_certs -text -noout</td></tr><tr class=""><td class="">Split Certs</td><td class=""><div class="softmerge-inner" style="width:1283px;left:-1px">csplit --prefix='cert.' --suffix-format='%03d.pem' --elide-empty-files <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'<br>find ./cert.*.pem -print0 | xargs -0r -I {} sh -c "printf {}; openssl x509 -in {} -text"</div></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Verify/View an individual cert/key</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">P12</td><td class="">Verify</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.p12</span> -alias <span style="font-weight:bold;">alias</span></td></tr><tr class=""><td class="" colspan="2">JKS</td><td class="">Verify</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.jks</span> -alias <span style="font-weight:bold;">alias</span></td></tr><tr class=""><td class="" colspan="2">PEM(Nx)</td><td class="">View</td><td class="">PEM(Nx) -&gt; PEM(1x), Verify PEM(1x)</td></tr><tr class=""><td class="" colspan="2" rowspan="7">PEM(1x)</td><td class="">Verify Key</td><td class="">openssl rsa -in&nbsp;<span style="font-weight:bold;">in.pem</span> -check</td></tr><tr class=""><td class="">Verify Cert</td><td class="">openssl x509 -in <span style="font-weight:bold;">in.pem</span> -text</td></tr><tr class=""><td class="">Verify Cert Chain</td><td class=""># May fail if intermediate certs are not in your truststore<br>openssl verify -CAfile <span style="font-weight:bold;">cacerts.pem</span> <span style="font-weight:bold;">my.pem</span></td></tr><tr class=""><td class="">Hash Cert</td><td class="">openssl x509 -noout -modulus -in <span style="font-weight:bold;">incert.pem</span> | openssl md5</td></tr><tr class=""><td class="">Hash Key</td><td class="">openssl rsa -noout -modulus -in <span style="font-weight:bold;">in.key</span> | openssl md5</td></tr><tr class=""><td class="">Correlate Key and Cert</td><td class="">Hash Key and Cert, then compare hashes - if equal, they are correlated</td></tr><tr class=""><td class="">Extract Public Key</td><td class="">openssl&nbsp;x509 -pubkey -noout -in <span style="font-weight:bold;">incert.pem</span> -out <span style="font-weight:bold;">public.key</span></td></tr><tr class=""><td class="" colspan="2">DER</td><td class="">Verify Either</td><td class="">keytool -printcert -v -file <span style="font-weight:bold;">in.der</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Delete from&nbsp;Bundle</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">P12</td><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="" colspan="2">JKS</td><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="" colspan="2">PEM(Nx)</td><td class="">Delete</td><td class="">Use a text editor</td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Generate RSA Keys</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Generate Private Key (as DES3)</td><td class="">Generate</td><td class="">openssl genrsa -des3 <span style="font-weight:bold;">-out id_rsa</span> -passout pass:<span style="font-weight:bold;">mys3curep4$$w0rd</span> 2048</td></tr><tr class=""><td class="" colspan="2">Extract Public Key</td><td class="">Derive</td><td class="">openssl rsa -in <span style="font-weight:bold;">id_rsa</span> -passin pass:<span style="font-weight:bold;">mys3curep4$$w0rd</span> -pubout -out <span style="font-weight:bold;">id_rsa.pub<br></span>OR<br>ssh-keygen -y -e -f <span style="font-weight:bold;">id_rsa</span></td></tr><tr class=""><td class="" colspan="2">Generate PuTTY Keypair</td><td class="">Generate</td><td class="">puttygen -t rsa -o <span style="font-weight:bold;">out.ppk</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Digest Signing</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">PEM(1x, Private Key)</td><td class="">Create Signature File</td><td class="">openssl dgst -sign <span style="font-weight:bold;">privkey.pem</span> -out <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="" colspan="2">PEM(1x, Private Key)</td><td class="">Check Signature via Private Key</td><td class="">openssl dgst -prverify <span style="font-weight:bold;">privkey.pem</span> -signature <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="" colspan="2">PEM(1x, Public Key)</td><td class="">Check Signature via Public Key</td><td class="">openssl dgst -verify <span style="font-weight:bold;">pubkey.pem</span> -signature <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="" colspan="2">PEM(1x, Certificate)</td><td class="">Extract Public Key from Cert</td><td class="">openssl x509 -pubkey -noout -in <span style="font-weight:bold;">cert.pem</span> &gt; <span style="font-weight:bold;">pubkey.pem</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Revocation (OCSP)</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Serial number and Issuer PEM</td><td class="">Check OCSP Status (Decimal)</td><td class="">openssl ocsp  -no_nonce -serial <span style="font-weight:bold;">012345 </span>-cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class=""></td><td class=""></td><td class="">Check OCSP Status (Hex)</td><td class="">openssl ocsp  -no_nonce -serial <span style="font-weight:bold;">0xAF1345 </span>-cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class="" colspan="2">Cert and Issuer PEM</td><td class="">Check OCSP Status</td><td class="">openssl ocsp  -no_nonce -issuer <span style="font-weight:bold;">chain.pem</span> -cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class="" colspan="2">Either</td><td class="">Save Request and Response</td><td class="">Add '<span style="font-family:Consolas,Arial;">-respout ocsp.resp -reqout ocsp.req</span>' to save them to the current folder</td></tr><tr class=""><td class="" colspan="2">Replay Request</td><td class="">Replay with Curl</td><td class="">curl -v -o /dev/null --data-binary @<span style="font-weight:bold;">ocsp.req</span> -H "Content-Type: application/ocsp-request" --url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Revocation (CRL)</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">PEM-CRL(Nx)</td><td class="">List CRL Issuers</td><td class=""><div class="softmerge-inner" style="width:1283px;left:-1px">csplit --prefix='cert.' --suffix-format='%03d.pem' --elide-empty-files <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'<br>find ./cert.*.pem -print0 | xargs -0r -I {} sh -c "printf {}; openssl x509 -in {} -text"</div></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">SSH Host Key</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">None</td><td class="">Generate a Host Key Set</td><td class="">ssh-keygen -f /etc/ssh/ssh_host_rsa_key -N '' -t rsa<br>ssh-keygen -f /etc/ssh/ssh_host_dsa_key -N '' -t dsa<br>ssh-keygen -f /etc/ssh/ssh_host_ecdsa_key -N '' -t ecdsa -b 521</td></tr><tr class=""><td class="" colspan="2">PEM(1x, Public Key and 1x, Private Key)<br>RSA Only</td><td class="">Convert and Place</td><td class=""><div class="softmerge-inner" style="width:1230px;left:-1px">openssl x509 -pubkey -noout -in <span style="font-weight:bold;">cert.pem</span> &gt; <span style="font-weight:bold;">pubkey.pem</span><br>rm /etc/ssh/*key*<br>ssh-keygen -f <span style="font-weight:bold;">pubkey.pem</span> -i -mPKCS8 &gt; /etc/ssh/ssh_host_rsa_key.pub<br>cp <span style="font-weight:bold;">key.pem</span> /etc/ssh/ssh_host_rsa_key</div></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Securing</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">PEM(Nx)</td><td class="">Change Passphrase</td><td class="">PEM(Nx) -&gt; PEM(1x), Change Passphrase, Text Editor</td></tr><tr class=""><td class="" colspan="2">PEM(1x)</td><td class="">Change Passphrase</td><td class="">openssl rsa -des3 -in <span style="font-weight:bold;">id_rsa</span> -out <span style="font-weight:bold;">id_rsa.new</span><br>OR<br>ssh-keygen -p -f <span style="font-weight:bold;">id_rsa</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Create a Self-Signed CA and Cert</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2" rowspan="2">Set up the CA</td><td class="">Create CA Key</td><td class="">openssl genrsa -out ca.key 4096</td></tr><tr class=""><td class="">Create CA Cert</td><td class="">openssl req -x509 -new -nodes -sha512 -days 3650 \
<br> -subj "CN=yourdomain.com" \
<br> -key ca.key \
<br> -out ca.crt</td></tr><tr class=""><td class="" colspan="2" rowspan="4">Create the Key and Cert</td><td class="">Create Key</td><td class="">openssl genrsa -out yourdomain.com.key 4096</td></tr><tr class=""><td class="">Create CSR</td><td class="">openssl req -sha512 -new \
<br>    -subj "CN=yourdomain.com" \
<br>    -key yourdomain.com.key \
<br>    -out yourdomain.com.csr</td></tr><tr class=""><td class="">Create x509 v3 ext.<br>for SANs</td><td class=""><div class="softmerge-inner" style="width:1992px;left:-1px">cat &gt; v3.ext &lt;&lt;-EOF
<br>authorityKeyIdentifier=keyid,issuer
<br>basicConstraints=CA:FALSE
<br>keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment
<br>extendedKeyUsage = serverAuth
<br>subjectAltName = @alt_names
<br>
<br>[alt_names]
<br>DNS.1=yourdomain.com
<br>DNS.2=yourdomain
<br>DNS.3=hostname
<br>EOF</div></td></tr><tr class=""><td class="">Create Cert</td><td class="">openssl x509 -req -sha512 -days 3650 \
<br>    -extfile v3.ext \
<br>    -CA ca.crt -CAkey ca.key -CAcreateserial \
<br>    -in yourdomain.com.csr \
<br>    -out yourdomain.com.crt</td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Troubleshooting a Web Server</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Basic TLS Handshake</td><td class="">List Accepted CAs, <br>Confirm TLS</td><td class="">openssl s_client -connect <span style="font-weight:bold;">remoteserver</span>:<span style="font-weight:bold;">443</span></td></tr><tr class=""><td class="" colspan="2">Test 2-way PKI</td><td class="">Handshake w/ Key/Cert</td><td class="">openssl s_client -showcerts -cert <span style="font-weight:bold;">cert.pem</span> -key <span style="font-weight:bold;">key.pem</span> -CAfile <span style="font-weight:bold;">cacerts.pem </span>-connect <span style="font-weight:bold;">remoteserver</span>:443 -debug</td></tr><tr class=""><td class="" colspan="2">Check TLS Vulns</td><td class="">List Ciphers, Attacks, etc.</td><td class="">docker run --rm -it drwetter/testssl.sh <span style="font-weight:bold;">remoteserver</span></td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Secure Password Prompt</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Batch/Powershell Password</td><td class="">Prompt</td><td class=""><div class="softmerge-inner" style="width:2353px;left:-1px">@echo off<br>set "psCommand=powershell -Command "$pword = read-host 'Enter Password' -AsSecureString ; ^<br>    $BSTR=[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pword); ^<br>        [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)""<br>for /f "usebackq delims=" %%p in (`%psCommand%`) do set password=%%p<br>echo %password%</div></td></tr><tr class=""><td class="" colspan="2">*nix Bash/zsh</td><td class="">Prompt</td><td class="">unset -v password # make sure it's not exported<br>set +o allexport  # make sure variables are not automatically exported<br>IFS= read -rs password &lt; /dev/tty</td></tr><tr class=""><td class="" colspan="2">Generate via openssl</td><td class="">Generate</td><td class="">openssl rand -base64 32</td></tr><tr class=""><td class=""></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Server Configuration</td><td class=""></td><td class=""></td></tr><tr class=""><td class="" colspan="2">Lock Down Ciphers/etc.</td><td class="">Get Config File</td><td class=""><a target="_blank" href="https://mozilla.github.io/server-side-tls/ssl-config-generator/">https://mozilla.github.io/server-side-tls/ssl-config-generator/</a></td></tr></tbody></table></figure>
</section></article>
    </div>


</body></html>