<html><head>
    <!-- <link type="text/css" rel="stylesheet" href="google-sheet.css"> -->
    <link type="text/css" rel="stylesheet" href="custom.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira Code">
</head>

<body>
    <div class="grid">
        <nav>
            <h1>Crypto Cheatsheet</h1>
            <ul><li><div>Commands</div><ul><li><a href="#View-Single Cert or Key">View Single Cert or Key</a></li><li><a href="#Convert-Between Formats">Convert Between Formats</a></li><li><a href="#View-Bundle Contents">View Bundle Contents</a></li><li><a href="#Create-Bundle">Create Bundle</a></li><li><a href="#Import-to Bundle">Import to Bundle</a></li><li><a href="#Export-from Bundle">Export from Bundle</a></li><li><a href="#Copy-Between Bundles">Copy Between Bundles</a></li><li><a href="#Copy-Between Bundles">Copy Between Bundles</a></li><li><a href="#Delete-from Bundle">Delete from Bundle</a></li><li><a href="#Create-a Self-Signed CA">Create a Self-Signed CA</a></li><li><a href="#Revocation-(OCSP)">Revocation (OCSP)</a></li><li><a href="#Revocation-(CRL)">Revocation (CRL)</a></li><li><a href="#SSH-Host Key">SSH Host Key</a></li><li><a href="#Generate-RSA Keys">Generate RSA Keys</a></li><li><a href="#Digest-Signing">Digest Signing</a></li><li><a href="#TLS-Troubleshooting">TLS Troubleshooting</a></li><li><a href="#Passphrase-Management">Passphrase Management</a></li><li><a href="#Password-Prompt Generate">Password Prompt Generate</a></li></ul></li><li><div>Reference Tables</div><ul><li><a href="#File-Types">File Types</a></li><li><a href="#Managing-Sensitive Keys">Managing Sensitive Keys</a></li><li><a href="#Hashing-Algorithms">Hashing Algorithms</a></li><li><a href="#Encryption-Algorithms">Encryption Algorithms</a></li><li><a href="#Key-Exchange">Key Exchange</a></li><li><a href="#Block-Cipher Mode of Operation">Block Cipher Mode of Operation</a></li><li><a href="#Cipher-Exchange-Mode-Combos">Cipher-Exchange-Mode Combos</a></li><li><a href="#Common-Errors">Common Errors</a></li><li><a href="#Socket-Encryption Standard">Socket Encryption Standard</a></li><li><a href="#Key-Usages">Key Usages</a></li><li><a href="#Common-Attacks">Common Attacks</a></li><li><a href="#Which-Should I Use">Which Should I Use</a></li><li><a href="#References-Links">References Links</a></li></ul></li></ul>
        </nav>
        <main><article id="commands"><h2>Commands</h2><section id="View-Single Cert or Key"><h3>View Single Cert or Key</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">P12</td><td class="">Verify</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.p12</span> -alias <span style="font-weight:bold;">alias</span></td></tr><tr class=""><td class="">JKS</td><td class="">Verify</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.jks</span> -alias <span style="font-weight:bold;">alias</span></td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">View</td><td class="">PEM(Nx) -&gt; PEM(1x), Verify PEM(1x)</td></tr><tr class=""><td class="" rowspan="7">PEM(1x)</td><td class="">Verify Key</td><td class="">openssl rsa -in&nbsp;<span style="font-weight:bold;">in.pem</span> -check</td></tr><tr class=""><td class="">Verify Cert</td><td class="">openssl x509 -in <span style="font-weight:bold;">in.pem</span> -text</td></tr><tr class=""><td class="">Verify Cert Chain</td><td class=""># May fail if intermediate certs are not in your truststore<br>openssl verify -CAfile <span style="font-weight:bold;">cacerts.pem</span> <span style="font-weight:bold;">my.pem</span></td></tr><tr class=""><td class="">Hash Cert</td><td class="">openssl x509 -noout -modulus -in <span style="font-weight:bold;">incert.pem</span> | openssl md5</td></tr><tr class=""><td class="">Hash Key</td><td class="">openssl rsa -noout -modulus -in <span style="font-weight:bold;">in.key</span> | openssl md5</td></tr><tr class=""><td class="">Correlate Key and Cert</td><td class="">Hash Key and Cert, then compare hashes - if equal, they are correlated</td></tr><tr class=""><td class="">Extract Public Key</td><td class="">openssl&nbsp;x509 -pubkey -noout -in <span style="font-weight:bold;">incert.pem</span> -out <span style="font-weight:bold;">public.key</span></td></tr><tr class=""><td class="">DER</td><td class="">Verify Either</td><td class="">keytool -printcert -v -file <span style="font-weight:bold;">in.der</span></td></tr></tbody></table></section><section id="Convert-Between Formats"><h3>Convert Between Formats</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>From</th><th>To</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">PEM(1x)</td><td class="">DER</td><td class="">Convert</td><td class="">openssl x509 -inform PEM -in <span style="font-weight:bold;">in.pem</span> -outform DER -out <span style="font-weight:bold;">out.der</span></td></tr><tr class=""><td class="">DER</td><td class="">PEM(1x)</td><td class="">Convert</td><td class="">openssl x509 -inform DER -in <span style="font-weight:bold;">in.der</span> -outform PEM -out <span style="font-weight:bold;">out.pem</span></td></tr></tbody></table></section><section id="View-Bundle Contents"><h3>View Bundle Contents</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">P12</td><td class="">List</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.p12</span>  <br>OR<br>openssl pkcs12 -info -in <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="">JKS</td><td class="">List</td><td class="">keytool -list -v -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="" rowspan="2">PEM(1x)</td><td class="">List Key</td><td class="">openssl rsa -in <span style="font-weight:bold;">store.pem</span> -check</td></tr><tr class=""><td class="">List Cert</td><td class="">openssl x509 -in <span style="font-weight:bold;">store.pem</span> -text</td></tr><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="">List Cert Subjects/Issuers</td><td class="">openssl crl2pkcs7 -nocrl -certfile <span style="font-weight:bold;">CHAINED.pem</span> | openssl pkcs7 -print_certs -noout</td></tr><tr class=""><td class="">List Cert Details</td><td class="">openssl crl2pkcs7 -nocrl -certfile <span style="font-weight:bold;">CHAINED.pem</span> | openssl pkcs7 -print_certs -text -noout</td></tr><tr class=""><td class="">Split Certs</td><td class=""><div class="softmerge-inner" style="left: -1px;">csplit --prefix='cert.' --suffix-format='%03d.pem' --elide-empty-files <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'<br>find ./cert.*.pem -print0 | xargs -0r -I {} sh -c "printf {}; openssl x509 -in {} -text"</div></td></tr></tbody></table></section><section id="Create-Bundle"><h3>Create Bundle</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="2">P12</td><td class="">Generate/Create</td><td class="">keytool -genkey -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp </span>-keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="" rowspan="2">JKS</td><td class="">Generate/Create</td><td class="">keytool -genkey -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="">PEM (1x or Nx)</td><td class="">Create</td><td class="">touch <span style="font-weight:bold;">store.pem</span></td></tr></tbody></table></section><section id="Import-to Bundle"><h3>Import to Bundle</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>From</th><th>To</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">PEM(1x)</td><td class="">PEM(Nx)</td><td class="">Import via Merge</td><td class="">cat <span style="font-weight:bold;">1.pem</span> &gt;&gt; <span style="font-weight:bold;">2.pem</span></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">P12</td><td class="">Import Cert and Key</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">certificate.p12</span> -inkey <span style="font-weight:bold;">inkey.pem</span> -in <span style="font-weight:bold;">incert.pem</span> -certfile<span style="font-weight:bold;"> CACert.pem</span></td></tr><tr class=""><td class="">PEM(1x)</td><td class="">JKS</td><td class="">Import</td><td class="">PEM(1x) -&gt; DER -&gt; JKS</td></tr><tr class=""><td class="">DER</td><td class="">PEM(Nx)</td><td class="">Import</td><td class="">DER -&gt; PEM(1x) -&gt; PEM</td></tr><tr class=""><td class="">DER</td><td class="">P12</td><td class="">Import</td><td class="">DER -&gt; PEM(1x) -&gt; P12</td></tr><tr class=""><td class="">DER</td><td class="">JKS</td><td class="">Import</td><td class="">keytool -import -alias <span style="font-weight:bold;">alias</span> -keystore <span style="font-weight:bold;">store.jks</span> -file <span style="font-weight:bold;">in.der</span></td></tr></tbody></table></section><section id="Export-from Bundle"><h3>Export from Bundle</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>From</th><th>To</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="" rowspan="3">PEM(1x)</td><td class="">Export via Split</td><td class="">Use a text editor and save a new file</td></tr><tr class=""><td class="">Cert-only csplit</td><td class="">csplit --prefix='cert.' --suffix-format='%03d.pem' <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'</td></tr><tr class=""><td class=""><a target="_blank" href="https://gist.github.com/jinnko/d6867ce326e8b6e88975">AWK Script</a></td><td class="">Handy AWK Script</td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">DER</td><td class="">Export via Split</td><td class="">PEM -&gt; PEM(1x) -&gt; DER</td></tr><tr class=""><td class="">P12</td><td class="">PEM(1x)</td><td class="">Export</td><td class="">P12 -&gt; PEM -&gt; PEM(1x)</td></tr><tr class=""><td class="">P12</td><td class="">DER</td><td class="">Export</td><td class="">keytool -export -alias <span style="font-weight:bold;">alias</span> -file <span style="font-weight:bold;">out.der</span> -keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="">JKS</td><td class="">PEM(1x)</td><td class="">Export</td><td class="">JKS -&gt; P12 -&gt; PEM -&gt; PEM(1x)</td></tr><tr class=""><td class="">JKS</td><td class="">DER</td><td class="">Export</td><td class="">keytool -export -alias <span style="font-weight:bold;">alias</span> -file&nbsp;<span style="font-weight:bold;">out.der</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr></tbody></table></section><section id="Copy-Between Bundles"><h3>Copy Between Bundles</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>From</th><th>To</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">store.p12</span> -in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">newstore.p12 </span>-in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Build a full-chain P12</td><td class="">cat <span style="font-weight:bold;">cacerts.pem cert.pem</span> &gt;&gt; <span style="font-weight:bold;">merged.pem<br></span>openssl pkcs12 -export -inkey <span style="font-weight:bold;">key.pem</span> -in <span style="font-weight:bold;">merged.pem </span>-name <span style="font-weight:bold;">myname </span>-out <span style="font-weight:bold;">mergedWithKey.pem</span></td></tr><tr class=""><td class="" rowspan="2">PEM(Nx)</td><td class="" rowspan="2">JKS</td><td class="">Convert</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="">Import to Existing</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="" rowspan="2">P12</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 -out <span style="font-weight:bold;">newstore.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 &gt;&gt; <span style="font-weight:bold;">store.pem</span></td></tr><tr class=""><td class="" rowspan="3">P12</td><td class="" rowspan="3">JKS</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">newstore.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import All to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -srcalias <span style="font-weight:bold;">alias</span>&nbsp;-destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="" rowspan="3">JKS</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks</span> -srcstoretype JKS -destkeystore <span style="font-weight:bold;">newstore.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import All&nbsp;to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in</span>.<span style="font-weight:bold;">jks </span>-srcstoretype JKS -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import&nbsp;One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks </span>-srcstoretype JKS -srcalias <span style="font-weight:bold;">alias</span> -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="" rowspan="2">JKS</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">JKS -&gt; P12 -&gt; PEM</td></tr><tr class=""><td class="">Import to Existing</td><td class="">JKS -&gt;&nbsp;P12 -&gt; PEM</td></tr><tr class=""><td class="" rowspan="2">PPK</td><td class="" rowspan="2">PEM(1x)</td><td class="">Extract Public Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">cert.pem</span> -O public</td></tr><tr class=""><td class="">Extract Private Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">key.pem </span>-O private-openssh</td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">PPK</td><td class="">Convert</td><td class="">puttygen <span style="font-weight:bold;">inkey.pem</span> -o <span style="font-weight:bold;">out.ppk </span>-O private</td></tr></tbody></table></section><section id="Copy-Between Bundles"><h3>Copy Between Bundles</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>From</th><th>To</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="3">PEM(Nx)</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">store.p12</span> -in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -export -out <span style="font-weight:bold;">newstore.p12 </span>-in <span style="font-weight:bold;">in.pem</span></td></tr><tr class=""><td class="">Build a full-chain P12</td><td class="">cat <span style="font-weight:bold;">cacerts.pem cert.pem</span> &gt;&gt; <span style="font-weight:bold;">merged.pem<br></span>openssl pkcs12 -export -inkey <span style="font-weight:bold;">key.pem</span> -in <span style="font-weight:bold;">merged.pem </span>-name <span style="font-weight:bold;">myname </span>-out <span style="font-weight:bold;">mergedWithKey.pem</span></td></tr><tr class=""><td class="" rowspan="2">PEM(Nx)</td><td class="" rowspan="2">JKS</td><td class="">Convert</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="">Import to Existing</td><td class="">PEM -&gt; P12 -&gt; JKS</td></tr><tr class=""><td class="" rowspan="2">P12</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 -out <span style="font-weight:bold;">newstore.pem</span></td></tr><tr class=""><td class="">Import to Existing</td><td class="">openssl pkcs12 -in <span style="font-weight:bold;">in</span>.p12 &gt;&gt; <span style="font-weight:bold;">store.pem</span></td></tr><tr class=""><td class="" rowspan="3">P12</td><td class="" rowspan="3">JKS</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">newstore.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import All to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="">Import One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.p12</span> -srcstoretype PKCS12 -srcalias <span style="font-weight:bold;">alias</span>&nbsp;-destkeystore <span style="font-weight:bold;">store.jks</span> -deststoretype JKS</td></tr><tr class=""><td class="" rowspan="3">JKS</td><td class="" rowspan="3">P12</td><td class="">Convert</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks</span> -srcstoretype JKS -destkeystore <span style="font-weight:bold;">newstore.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import All&nbsp;to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in</span>.<span style="font-weight:bold;">jks </span>-srcstoretype JKS -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="">Import&nbsp;One to Existing</td><td class="">keytool -importkeystore -srckeystore <span style="font-weight:bold;">in.jks </span>-srcstoretype JKS -srcalias <span style="font-weight:bold;">alias</span> -destkeystore <span style="font-weight:bold;">store.p12</span> -deststoretype PKCS12</td></tr><tr class=""><td class="" rowspan="2">JKS</td><td class="" rowspan="2">PEM(Nx)</td><td class="">Convert</td><td class="">JKS -&gt; P12 -&gt; PEM</td></tr><tr class=""><td class="">Import to Existing</td><td class="">JKS -&gt;&nbsp;P12 -&gt; PEM</td></tr><tr class=""><td class="" rowspan="2">PPK</td><td class="" rowspan="2">PEM(1x)</td><td class="">Extract Public Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">cert.pem</span> -O public</td></tr><tr class=""><td class="">Extract Private Key</td><td class="">puttygen <span style="font-weight:bold;">in.ppk</span> -o <span style="font-weight:bold;">key.pem </span>-O private-openssh</td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">PPK</td><td class="">Convert</td><td class="">puttygen <span style="font-weight:bold;">inkey.pem</span> -o <span style="font-weight:bold;">out.ppk </span>-O private</td></tr></tbody></table></section><section id="Delete-from Bundle"><h3>Delete from Bundle</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">P12</td><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.p12</span></td></tr><tr class=""><td class="">JKS</td><td class="">Delete</td><td class="">keytool -delete -alias <span style="font-weight:bold;">temp</span> -keystore <span style="font-weight:bold;">store.jks</span></td></tr><tr class=""><td class="">PEM(Nx)</td><td class="">Delete</td><td class="">Use a text editor</td></tr></tbody></table></section><section id="Create-a Self-Signed CA"><h3>Create a Self-Signed CA</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="2">Set up the CA</td><td class="">Create CA Key</td><td class="">openssl genrsa -out <span style="font-weight:bold;">ca.key</span> 4096</td></tr><tr class=""><td class="">Create CA Cert</td><td class="">openssl req -x509 -new -nodes -sha512 -days <span style="font-weight:bold;">3650</span> \<br> -subj <span style="font-weight:bold;">"CN=yourdomain.com"</span> \<br> -key <span style="font-weight:bold;">ca.key</span> \<br> -out <span style="font-weight:bold;">ca.crt</span></td></tr><tr class=""><td class="" rowspan="3">Create the Key and Cert</td><td class="">Create Key</td><td class="">openssl genrsa -out <span style="font-weight:bold;">yourdomain.com.key</span> 4096</td></tr><tr class=""><td class="">Create CSR</td><td class="">openssl req -sha512 -new \<br>    -subj <span style="font-weight:bold;">"CN=yourdomain.com" </span>\<br>    -key <span style="font-weight:bold;">yourdomain.com.key</span> \<br>    -out <span style="font-weight:bold;">yourdomain.com.csr</span></td></tr><tr class=""><td class="">Create x509 v3 ext.<br>for SANs</td><td class=""><div class="softmerge-inner" style="left: -1px;">cat &gt; v3.ext &lt;&lt;-EOF<br>authorityKeyIdentifier=keyid,issuer<br>basicConstraints=CA:FALSE<br>keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment<br>extendedKeyUsage = serverAuth<br>subjectAltName = @alt_names<br><br>[alt_names]<br>DNS.1=<span style="font-weight:bold;">yourdomain.com</span><br>DNS.2=<span style="font-weight:bold;">yourdomain</span><br>DNS.3=<span style="font-weight:bold;">hostname</span><br>EOF</div></td></tr></tbody></table></section><section id="Revocation-(OCSP)"><h3>Revocation (OCSP)</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="" rowspan="2">Serial number and Issuer PEM</td><td class="">Check OCSP Status (Decimal)</td><td class="">openssl ocsp  -no_nonce -serial <span style="font-weight:bold;">012345 </span>-cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class="">Check OCSP Status (Hex)</td><td class="">openssl ocsp  -no_nonce -serial <span style="font-weight:bold;">0xAF1345 </span>-cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class="">Cert and Issuer PEM</td><td class="">Check OCSP Status</td><td class="">openssl ocsp  -no_nonce -issuer <span style="font-weight:bold;">chain.pem</span> -cert <span style="font-weight:bold;">certificate.pem</span> -text -url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr><tr class=""><td class="">Either</td><td class="">Save Request and Response</td><td class=""># Add '<span style="font-family:Consolas,Arial;">-respout </span><span style="font-family:Consolas,Arial;font-weight:bold;">ocsp.resp</span><span style="font-family:Consolas,Arial;"> -reqout </span><span style="font-family:Consolas,Arial;font-weight:bold;">ocsp.req</span>' to save them to the current folder</td></tr><tr class=""><td class="">Replay Request</td><td class="">Replay with Curl</td><td class="">curl -v -o /dev/null --data-binary @<span style="font-weight:bold;">ocsp.req</span> -H "Content-Type: application/ocsp-request" --url <span style="font-weight:bold;text-decoration:underline;-webkit-text-decoration-skip:none;text-decoration-skip-ink:none;color:#1155cc;"><a target="_blank" href="http://ocsp.my.ca.tld/">http://ocsp.my.ca.tld</a></span></td></tr></tbody></table></section><section id="Revocation-(CRL)"><h3>Revocation (CRL)</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">PEM-CRL(Nx)</td><td class="">List CRL Issuers</td><td class=""><div class="softmerge-inner" style="left: -1px;">csplit --prefix='cert.' --suffix-format='%03d.pem' --elide-empty-files <span style="font-weight:bold;">multicert.pem </span>'/-----BEGIN CERTIFICATE-----/' '{*}'<br>find ./cert.*.pem -print0 | xargs -0r -I {} sh -c "printf {}; openssl x509 -in {} -text"</div></td></tr></tbody></table></section><section id="SSH-Host Key"><h3>SSH Host Key</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">None</td><td class="">Generate a Host Key Set</td><td class="">ssh-keygen -f /etc/ssh/ssh_host_rsa_key -N '' -t rsa<br>ssh-keygen -f /etc/ssh/ssh_host_dsa_key -N '' -t dsa<br>ssh-keygen -f /etc/ssh/ssh_host_ecdsa_key -N '' -t ecdsa -b 521</td></tr><tr class=""><td class="">PEM(1x, Public Key and 1x, Private Key)<br>RSA Only</td><td class="">Convert and Place</td><td class=""><div class="softmerge-inner" style="left: -1px;">openssl x509 -pubkey -noout -in <span style="font-weight:bold;">cert.pem</span> &gt; <span style="font-weight:bold;">pubkey.pem</span><br>rm /etc/ssh/*key*<br>ssh-keygen -f <span style="font-weight:bold;">pubkey.pem</span> -i -mPKCS8 &gt; /etc/ssh/ssh_host_rsa_key.pub<br>cp <span style="font-weight:bold;">key.pem</span> /etc/ssh/ssh_host_rsa_key</div></td></tr></tbody></table></section><section id="Generate-RSA Keys"><h3>Generate RSA Keys</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th><div class="softmerge-inner" style="left: -3px;">Operation</div></th><th>Command</th></tr></thead><tbody><tr class=""><td class=""><div class="softmerge-inner" style="left: -6px;">Generate Private Key (as DES3)</div></td><td class="">Generate</td><td class="">openssl genrsa -des3 -out <span style="font-weight:bold;">id_rsa</span> -passout pass:<span style="font-weight:bold;">mys3curep4$$w0rd</span> 2048</td></tr><tr class=""><td class="">Extract Public Key</td><td class="">Derive</td><td class="">openssl rsa -in <span style="font-weight:bold;">id_rsa</span> -passin pass:<span style="font-weight:bold;">mys3curep4$$w0rd</span> -pubout -out <span style="font-weight:bold;">id_rsa.pub<br></span># OR<br>ssh-keygen -y -e -f <span style="font-weight:bold;">id_rsa</span></td></tr><tr class=""><td class="">Generate PuTTY Keypair</td><td class="">Generate</td><td class="">puttygen -t rsa -o <span style="font-weight:bold;">out.ppk</span></td></tr></tbody></table></section><section id="Digest-Signing"><h3>Digest Signing</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">PEM(1x, Private Key)</td><td class="">Create Signature File</td><td class="">openssl dgst -sign <span style="font-weight:bold;">privkey.pem</span> -out <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="">PEM(1x, Private Key)</td><td class="">Check Signature via Private Key</td><td class="">openssl dgst -prverify <span style="font-weight:bold;">privkey.pem</span> -signature <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="">PEM(1x, Public Key)</td><td class="">Check Signature via Public Key</td><td class="">openssl dgst -verify <span style="font-weight:bold;">pubkey.pem</span> -signature <span style="font-weight:bold;">sigfile.sha256 datafile</span></td></tr><tr class=""><td class="">PEM(1x, Certificate)</td><td class="">Extract Public Key from Cert</td><td class="">openssl x509 -pubkey -noout -in <span style="font-weight:bold;">cert.pem</span> &gt; <span style="font-weight:bold;">pubkey.pem</span></td></tr></tbody></table></section><section id="TLS-Troubleshooting"><h3>TLS Troubleshooting</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">Basic TLS Handshake</td><td class="">List Accepted CAs, <br>Confirm TLS</td><td class="">openssl s_client -connect <span style="font-weight:bold;">remoteserver</span>:<span style="font-weight:bold;">443</span></td></tr><tr class=""><td class="">Test 2-way PKI</td><td class="">Handshake w/ Key/Cert</td><td class="">openssl s_client -showcerts -cert <span style="font-weight:bold;">cert.pem</span> -key <span style="font-weight:bold;">key.pem</span> -CAfile <span style="font-weight:bold;">cacerts.pem </span>-connect <span style="font-weight:bold;">remoteserver</span>:443 -debug</td></tr><tr class=""><td class="">Check TLS Vulns</td><td class="">List Ciphers, Attacks, etc.</td><td class="">docker run --rm -it drwetter/testssl.sh <span style="font-weight:bold;">remoteserver</span></td></tr></tbody></table></section><section id="Passphrase-Management"><h3>Passphrase Management</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">PEM(Nx)</td><td class="">Change Passphrase</td><td class="">PEM(Nx) -&gt; PEM(1x), Change Passphrase, Text Editor</td></tr><tr class=""><td class="">PEM(1x)</td><td class="">Change Passphrase</td><td class="">openssl rsa -des3 -in <span style="font-weight:bold;">id_rsa</span> -out <span style="font-weight:bold;">id_rsa.new</span><br>OR<br>ssh-keygen -p -f <span style="font-weight:bold;">id_rsa</span></td></tr></tbody></table></section><section id="Password-Prompt Generate"><h3>Password Prompt Generate</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Type</th><th>Operation</th><th>Command</th></tr></thead><tbody><tr class=""><td class="">Batch/Powershell Password</td><td class="">Prompt</td><td class=""><div class="softmerge-inner" style="left: -1px;">@echo off<br>REM See http://blogs.msdn.com/b/fpintos/archive/2009/06/12/how-to-properly-convert-securestring-to-string.aspx - this may stay in memory as an unfreed buffer
<br>REM Still better than echoing or writing to disk<br>set "psCommand=powershell -Command "$pword = read-host 'Enter Password' -AsSecureString ; ^<br>    $BSTR=[System.Runtime.InteropServices.Marshal]::SecureStringToBSTR($pword); ^<br>        [System.Runtime.InteropServices.Marshal]::PtrToStringAuto($BSTR)""<br>for /f "usebackq delims=" %%p in (`%psCommand%`) do set password=%%p<br>echo %password%</div></td></tr><tr class=""><td class="">*nix Bash/zsh</td><td class="">Prompt</td><td class="">unset -v password # make sure it's not exported<br>set +o allexport  # make sure variables are not automatically exported<br>IFS= read -rs password &lt; /dev/tty</td></tr><tr class=""><td class="">Generate via openssl</td><td class="">Generate</td><td class="">openssl rand -base64 32</td></tr></tbody></table></section></article><article id="reference-tables"><h2>Reference Tables</h2><section id="File-Types"><h3>File Types</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>File Type</th><th>Description</th><th>Think of</th><th>Common Extensions</th><th>Wiki Page</th><th>Identification Method</th><th><div class="softmerge-inner" style="left: -1px;">File type</div></th><th>Contains</th><th><div class="softmerge-inner" style="left: -1px;">Encrypted</div></th><th>Sensitive</th><th>Notes</th></tr></thead><tbody><tr class=""><td class="">PKCS12/PFX</td><td class=""><div class="softmerge-inner" style="left: -1px;">PKCS#12 Certificate Bundle</div></td><td class="">A binary blob of multiple certs and keys</td><td class="">.p12 .pfx</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/PKCS_12">https://en.wikipedia.org/wiki/PKCS_12</a></td><td class="">file command: data, openssl verify</td><td class="">BINARY</td><td class="">Key(s), Cert(s)</td><td class="">Yes</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">PEM</td><td class="">X.509 Bundle</td><td class="">Base64-encode&nbsp;1+&nbsp;DER's with headers</td><td class="">.pem</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail">https://en.wikipedia.org/wiki/Privacy-enhanced_Electronic_Mail</a></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN</span></td><td class="">ASCII</td><td class=""><div class="softmerge-inner" style="left: -1px;">Key(s), Cert(s), Request(s)</div></td><td class="">Maybe</td><td class="">Sometimes</td><td class=""><div class="softmerge-inner" style="left: -1px;">PEM(1x) = PEM with one key or cert; PEM(Nx) = PEM with one or more keys or certs</div></td></tr><tr class=""><td class="">DER</td><td class="">DER-encoded Certificate</td><td class="">A binary blob with actual data</td><td class="">.der .cer .crt .cert .pem</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/X.690#DER_encoding">https://en.wikipedia.org/wiki/X.690#DER_encoding</a></td><td class="">file command: data, openssl verify </td><td class="">BINARY</td><td class="">Key OR Cert OR Request</td><td class="">No</td><td class="">Sometimes</td><td class=""></td></tr><tr class=""><td class="">P7B</td><td class="">PKCS#7 Certificate</td><td class="">Certs for sharing/recognizing</td><td class="">.p7b</td><td class=""></td><td class="">???</td><td class=""></td><td class="">Cert(s)</td><td class="">No</td><td class="">Sometimes</td><td class=""></td></tr><tr class=""><td class="">CRL</td><td class="">Certificate Revocation List</td><td class="">Telling everyone a cert is no longer good</td><td class="">.crl</td><td class=""></td><td class="">???</td><td class=""></td><td class="">Revocation(s)</td><td class=""></td><td class="">No</td><td class=""></td></tr><tr class=""><td class="">'CSR'</td><td class=""><div class="softmerge-inner" style="left: -1px;">Certificate Signing Request</div></td><td class=""><div class="softmerge-inner" style="left: -1px;">Typically&nbsp;a PEM with just a request and named differently!</div></td><td class="">.csr</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN CERTIFICATE REQUEST-----</span></td><td class="">ASCII</td><td class="">Request (but any PEM)</td><td class="">Maybe</td><td class="">If misnamed</td><td class=""></td></tr><tr class=""><td class="">'KEY'</td><td class="">Key</td><td class="">Typically a PEM with just a key and named differently!</td><td class="">.key .rsa</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN </span>and <span style="font-family:Courier New;">KEY-----</span></td><td class="">ASCII</td><td class="">Key (but any PEM)</td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">CERT'</td><td class="">Certificate</td><td class=""><div class="softmerge-inner" style="left: -1px;">Typically&nbsp;a PEM with just a cert and named differently!</div></td><td class="">.cert</td><td class=""></td><td class="">contains <span style="font-family:Courier New;">-----BEGIN CERTIFICATE-----</span></td><td class="">ASCII</td><td class="">Cert (but any PEM)</td><td class="">Maybe</td><td class="">If misnamed</td><td class=""></td></tr><tr class=""><td class="">JKS</td><td class="">Java KeyStore</td><td class="">A binary blob of multiple certs and keys</td><td class="">.jks .keystore .truststore </td><td class=""></td><td class="">???</td><td class="">BINARY</td><td class=""></td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">BKS</td><td class="">BouncyCastle KeyStore</td><td class="">A binary blob of multiple certs and keys</td><td class="">.bks</td><td class=""><a target="_blank" href="http://www.bouncycastle.org/specifications.html">http://www.bouncycastle.org/specifications.html</a></td><td class="">???</td><td class="">BINARY</td><td class=""></td><td class=""></td><td class="">Usually</td><td class=""></td></tr><tr class=""><td class="">PPK</td><td class="">Putty Key File</td><td class="">A PuTTY-specific format for Private keys</td><td class="">.ppk</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://the.earth.li/~sgtatham/putty/0.76/htmldoc/AppendixC.html#ppk">https://the.earth.li/~sgtatham/putty/0.76/htmldoc/AppendixC.html#ppk</a></div></td><td class="">???</td><td class="">ASCII</td><td class="">Public and Private Key</td><td class="">Maybe</td><td class="">Usually</td><td class=""></td></tr></tbody></table></section><section id="Managing-Sensitive Keys"><h3>Managing Sensitive Keys</h3><p>One of the biggest risks with cert and key stores/bundles is not managing the encryption properly.</p>
<ul>
<li>It's easy to store them encrypted (with a passphrase) or unencrypted.</li>
<li>A store can contain cert(s), key(s) or both.</li>
<li>Many of the commands to do transformations aren't entirely clear to the untrained eye.</li>
<li>In some cases, you need a copy of the key that is unencrypted (for example, to plug into an app that doesn't accept a passphrase).</li>
</ul>
<p>It's helpful to separate SENSITIVITY and SECURITY:</p>
<ul>
<li>A store is SENSITIVE if it contains a private key.</li>
<li>A store is SECURE only if it is encrypted and requires a password/passphrase to decrypt any and all private keys.</li>
</ul>
<p>As a general rule:</p>
<ul>
<li>Name files to reflect their sensitivity - one easy way is to name files with private keys with 'key' in the name or extension.</li>
<li>Save an unencrypted private key to disk as rarely as possible, and only on local hardware (avoid S3, NFS, etc.)</li>
<li>Verify the contents of any transformations you apply to a store.</li>
</ul>
<h4>PEM</h4>
<h5>To make a SECURE PEM:</h5>
<ul>
<li>Use the open SSL commands on the next tab</li>
<li>Make sure '-nodes' is not specified on an openssl pkcs12 export</li>
<li>Make sure one of the valid encryption modes from the list below are in the command (-aes256 or -camellia256 recommended)</li>
</ul>
<h5>To make an INSECURE PEM:</h5>
<ul>
<li>Use the open SSL commands on the next tab</li>
<li>Ensure that you are working with a non-SENSITIVE key - ie, a public key, a limited-lifespan decrypted copy of a private key, or a single-use key.</li>
<li>Add '-nodes' to the command to skip the encryption step in an export or generate operation</li>
<li>Make sure none of the valid encryption modes from the list below are in the command</li>
</ul>
<h5>OpenSSL Encryption Flags</h5>
<ul>
<li>-nodes: Do not encrypt output. Only required on exports from other formats ('openssl pkcs12) or generation ('openssl req') (completely insecure!)</li>
<li>-des: Usse DES encryption (insecure)</li>
<li>-des3: Use Triple DES encryption (default on 'openssl pkcs12' export, but must be supplied in a 'openssl rsa' operation) (potentially insecure)</li>
<li>-idea: Use IDEA encryption (insecure)</li>
<li>-seed: Use SEED encryption (not recommended unless in Korea due to low interoperability)</li>
<li>-aes128, -aes192, -aes256: Use CBC AES encryption with the given key strength (aes256 recommended)</li>
<li>-camellia128, -camellia192, -camellia256: Use CBC Camellia encryption with the given key strength (camellia256 recommended)</li>
</ul>
<h5>To examine a PEM for SENSITIVITY and SECURITY:</h5>
<ol>
<li>Use a text editor or known-good script to isolate the individual certs and keys within a PEM
(ie, save each as a new file - recommend using name.pem for certs and number.key for keys until matches are verified)</li>
<li>For each single PEM file (in_single.pem in our examples), verify appropriately:</li>
</ol>
<ul>
<li>If any PRIVATE KEYs are present, the PEM is SENSITIVE and should be encrypted in the vast majority of circumstances; verify it with <code>openssl rsa -in in_single.pem -check</code>. If you aren't asked for a password, it's not encrypted and is INSECURE!</li>
<li>If any CERTIFICATES are present, they should be verified to ensure validity (proper issuer, expected subject, date range) verify it with <code>openssl x509 -in in.pem -text</code> and verified against a private key if you hold that key (<code>openssl x509 -noout -modulus -in incert.pem | openssl md5</code> on the cert and <code>openssl rsa -noout -modulus -in in.key | openssl md5</code> on the key should yield the same hash);</li>
<li>If any PUBLIC KEYs or CERTIFICATES are present, they should be verified against a private key if you hold that key (<code>openssl x509 -noout -modulus -in incert.pem | openssl md5</code> on the cert and <code>openssl rsa -noout -modulus -in in.key | openssl md5</code> on the key should yield the same hash);</li>
</ul>
<ul>
<li>If you are not asked for a password for each PRIVATE key, it's likely that the PEM is INSECURE</li>
</ul>
<p>The bag attributes in a multi-object PEM can be used to help correlate but are NOT a guarantee - these sections are not secured!</p>
</section><section id="Hashing-Algorithms"><h3>Hashing Algorithms</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Identifier</th><th>Algorithm Name</th><th><div class="softmerge-inner" style="left: -1px;">Digest Strengths</div></th><th><div class="softmerge-inner" style="left: -1px;">Secure As of 2016-10-01</div></th><th>Wikipedia</th></tr></thead><tbody><tr class=""><td class="">MD2</td><td class="">Message Digest Algorithm 2</td><td class="">128</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/MD2">https://en.wikipedia.org/wiki/MD2</a></td></tr><tr class=""><td class="">MD4</td><td class="">Message Digest Algorithm 4</td><td class="">128</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/MD4">https://en.wikipedia.org/wiki/MD4</a></td></tr><tr class=""><td class="">MD5</td><td class="">Message Digest Algorithm 5</td><td class="">128</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/MD5">https://en.wikipedia.org/wiki/MD5</a></td></tr><tr class=""><td class="">MD6</td><td class="">Message Digest Algorithm 6</td><td class="">0-512</td><td class="">Unverified</td><td class=""></td></tr><tr class=""><td class="">SHA-0</td><td class="">Secure Hash Algorithm 0</td><td class="">160</td><td class="">No</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-1#SHA-0">https://en.wikipedia.org/wiki/SHA-1#SHA-0</a></div></td></tr><tr class=""><td class="">SHA-1</td><td class="">Secure Hash Algorithm 1</td><td class="">160</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-1">https://en.wikipedia.org/wiki/SHA-1</a></td></tr><tr class=""><td class="">SHA-2</td><td class="">Secure Hash Algorithm 2</td><td class=""><div class="softmerge-inner" style="left: -1px;">224, 256, 384, 512</div></td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-3</td><td class="">Secure Hash Algorithm 3</td><td class=""></td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a></td></tr><tr class=""><td class="">SHA-224</td><td class="">Secure Hash Algorithm 2, 224-bit</td><td class="">224</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-256</td><td class="">Secure Hash Algorithm 2, 256-bit</td><td class="">256</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-384</td><td class="">Secure Hash Algorithm 2, 384-bit</td><td class="">384</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-512</td><td class="">Secure Hash Algorithm 2, 512-bit</td><td class="">512</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-512/224</td><td class=""><div class="softmerge-inner" style="left: -1px;">Secure Hash Algorithm 2, 512-bit with 224-bit IV</div></td><td class="">512 with 224 IV</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA-512/256</td><td class=""><div class="softmerge-inner" style="left: -1px;">Secure Hash Algorithm 2, 512-bit with 256-bit IV</div></td><td class="">512 with 256 IV</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-2">https://en.wikipedia.org/wiki/SHA-2</a></td></tr><tr class=""><td class="">SHA3-224</td><td class="">Secure Hash Algorithm 3, 224-bit</td><td class="">224</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a></td></tr><tr class=""><td class="">SHA3-256</td><td class="">Secure Hash Algorithm 3, 256-bit</td><td class="">256</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a></td></tr><tr class=""><td class="">SHA3-384</td><td class="">Secure Hash Algorithm 3, 384-bit</td><td class="">384</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a></td></tr><tr class=""><td class="">SHA3-512</td><td class="">Secure Hash Algorithm 3, 512-bit</td><td class="">512</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SHA-3">https://en.wikipedia.org/wiki/SHA-3</a></td></tr></tbody></table></section><section id="Encryption-Algorithms"><h3>Encryption Algorithms</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Identifier</th><th>Algorithm Name</th><th>Key Type</th><th>Key Lengths</th><th><div class="softmerge-inner" style="left: -1px;">Block Sizes</div></th><th>Generally Secure</th><th>Wikipedia</th></tr></thead><tbody><tr class=""><td class="">AES</td><td class=""><div class="softmerge-inner" style="left: -1px;">Advanced Encryption Standard (Rijndael)</div></td><td class="">Symmetric</td><td class="">128, 192, 256</td><td class="">128</td><td class="">Yes</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard">https://en.wikipedia.org/wiki/Advanced_Encryption_Standard</a></div></td></tr><tr class=""><td class="">DES</td><td class="">Data Encryption Standard</td><td class="">Symmetric</td><td class="">56</td><td class="">64</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Data_Encryption_Standard">https://en.wikipedia.org/wiki/Data_Encryption_Standard</a></td></tr><tr class=""><td class="">3DES</td><td class="">Triple Data Encryption Standard</td><td class="">Symmetric</td><td class="">56, 112, 168</td><td class="">64</td><td class="">No - Meet-in-the-middle attack</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Triple_DES">https://en.wikipedia.org/wiki/Triple_DES</a></td></tr><tr class=""><td class="">Blowfish</td><td class="">Blowfish</td><td class="">Symmetric</td><td class="">32-448</td><td class="">64</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Blowfish_%28cipher%29">https://en.wikipedia.org/wiki/Blowfish_%28cipher%29</a></td></tr><tr class=""><td class="">Twofish</td><td class="">Twofish</td><td class="">Symmetric</td><td class="">128, 192, 256</td><td class="">128</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Twofish">https://en.wikipedia.org/wiki/Twofish</a></td></tr><tr class=""><td class="">RC2</td><td class="">Rivest Cipher 2</td><td class="">Symmetric</td><td class="">8-1024</td><td class="">64</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/RC2">https://en.wikipedia.org/wiki/RC2</a></td></tr><tr class=""><td class="">RC4</td><td class="">Rivest Cipher 4</td><td class="">Symmetric</td><td class="">40-2048</td><td class=""></td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/RC4">https://en.wikipedia.org/wiki/RC4</a></td></tr><tr class=""><td class="">RC5</td><td class="">Rivest Cipher 5</td><td class="">Symmetric</td><td class="">0-2040</td><td class="">32, 64, 128</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/RC5">https://en.wikipedia.org/wiki/RC5</a></td></tr><tr class=""><td class="">RC6</td><td class="">Rivest Cipher 6</td><td class="">Symmetric</td><td class="">128, 192, 256</td><td class="">128</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/RC6">https://en.wikipedia.org/wiki/RC6</a></td></tr><tr class=""><td class="">ROT</td><td class="">Rotational Cipher</td><td class="">Symmetric</td><td class="">4-16</td><td class="">1</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/ROT13">https://en.wikipedia.org/wiki/ROT13</a></td></tr><tr class=""><td class="">ROT13</td><td class="">Rotational Cipher (13 moves)</td><td class="">Symmetric</td><td class="">4</td><td class="">1</td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/ROT13">https://en.wikipedia.org/wiki/ROT13</a></td></tr><tr class=""><td class=""></td><td class="">Vigenere Cipher</td><td class=""></td><td class=""></td><td class=""></td><td class="">No</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher">https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher</a></td></tr><tr class=""><td class="">RSA</td><td class="">RivestShamirAdleman Cipher</td><td class="">Asymmetric</td><td class="">1024-4096</td><td class=""></td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)">https://en.wikipedia.org/wiki/RSA_(cryptosystem)</a></td></tr><tr class=""><td class="">SEED</td><td class="">SEED</td><td class="">Symmetric</td><td class="">128</td><td class="">128</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/SEED">https://en.wikipedia.org/wiki/SEED</a></td></tr><tr class=""><td class="">IDEA</td><td class=""><div class="softmerge-inner" style="left: -1px;">International Data Encryption Algorithm</div></td><td class="">Symmetric</td><td class="">128</td><td class="">64</td><td class=""><div class="softmerge-inner" style="left: -1px;">No - Weak Keys, Generally Obsolete</div></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/International_Data_Encryption_Algorithm">https://en.wikipedia.org/wiki/International_Data_Encryption_Algorithm</a></div></td></tr><tr class=""><td class="">Camellia</td><td class="">Camellia</td><td class="">Symmetric</td><td class="">128, 192, 256</td><td class="">128</td><td class="">Yes</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Camellia_(cipher)">https://en.wikipedia.org/wiki/Camellia_(cipher)</a></td></tr></tbody></table></section><section id="Key-Exchange"><h3>Key Exchange</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Identifier</th><th>Algorithm Name</th><th>Notes</th><th>Generally Secure of 2016-10-01</th><th>Wikipedia</th></tr></thead><tbody><tr class=""><td class="">ECDH</td><td class="">Elliptic Curve Diffie Hellman</td><td class=""></td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman">https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman</a></div></td></tr><tr class=""><td class="">ECDHE</td><td class="">Elliptic Curve Diffie Hellman Ephemeral</td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDSA</td><td class="">Elliptic Curve Digital Signature Algorithm</td><td class=""></td><td class="">No</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm">https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm</a></div></td></tr><tr class=""><td class="">DSA</td><td class="">Digital Signature Algorithm</td><td class=""></td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Digital_Signature_Algorithm">https://en.wikipedia.org/wiki/Digital_Signature_Algorithm</a></td></tr></tbody></table></section><section id="Block-Cipher Mode of Operation"><h3>Block Cipher Mode of Operation</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Identifier</th><th>Algorithm Name</th><th>Notes</th><th>Generally Secure of 2016-10-01</th><th>Wikipedia</th></tr></thead><tbody><tr class=""><td class="">GCM</td><td class="">Galois Counter Mode</td><td class=""></td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Galois/Counter_Mode">https://en.wikipedia.org/wiki/Galois/Counter_Mode</a></td></tr><tr class=""><td class="">ECB</td><td class="">Electronic Code Book</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;">No, susceptible to pattern and rainbow attacks</div></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29">https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Electronic_Codebook_.28ECB.29</a></div></td></tr><tr class=""><td class="">CBC</td><td class="">Cipher Block Chaining</td><td class=""></td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29">https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_.28CBC.29</a></div></td></tr><tr class=""><td class="">PCBC</td><td class="">Propagating Cipher Block Chaining</td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">CCM</td><td class=""><div class="softmerge-inner" style="left: -1px;">Cipher Block Chaining - Message Authentication Mode</div></td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">EDE</td><td class="">Encrypt-Decrypt-Encrypt</td><td class=""><div class="softmerge-inner" style="left: -1px;">Used to perform DES on 3DES Accelerated Hardware platforms</div></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">CFB</td><td class="">Cipher Feedback</td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">OFB</td><td class="">Output feedback</td><td class=""></td><td class=""></td><td class=""></td></tr><tr class=""><td class="">CTR</td><td class="">Counter mode</td><td class=""></td><td class=""></td><td class=""></td></tr></tbody></table></section><section id="Cipher-Exchange-Mode-Combos"><h3>Cipher-Exchange-Mode Combos</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Name</th><th>Security Level From Mozilla as of 2018-06-29</th><th>Known Attacks</th><th>Min TLS Level</th></tr></thead><tbody><tr class=""><td class="">AES128-GCM-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">AES128-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">AES128-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">AES256-GCM-SHA384</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">AES256-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">AES256-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DES-CBC3-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES128-GCM-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES128-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES128-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES256-GCM-SHA384</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES256-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-RSA-AES256-SHA256</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-ECDSA-AES128-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-ECDSA-AES256-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-RSA-AES128-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-RSA-AES256-SHA</td><td class="">Intermediate</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-ECDSA-AES128-GCM-SHA256</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-ECDSA-AES128-SHA256</td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-ECDSA-AES256-GCM-SHA384</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-ECDSA-AES256-SHA384</td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-ECDSA-CHACHA20-POLY1305</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-RSA-AES128-GCM-SHA256</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-RSA-AES128-SHA256</td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-RSA-AES256-GCM-SHA384</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">ECDHE-RSA-AES256-SHA384</td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">ECDHE-RSA-CHACHA20-POLY1305</div></td><td class="">Modern</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-DSS-AES128-GCM-SHA256</td><td class="">Old</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-DSS-AES128-SHA256</td><td class="">Old</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">DHE-DSS-AES256-SHA</td><td class="">Old</td><td class=""></td><td class=""></td></tr></tbody></table></section><section id="Common-Errors"><h3>Common Errors</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>App</th><th>Error</th><th>What does it mean?</th><th>How to address?</th></tr></thead><tbody><tr class=""><td class="">Java</td><td class="">javax.net.ssl.SSLHandshakeException: Received fatal alert: bad_certificate</td><td class=""><div class="softmerge-inner" style="left: -1px;">The server has rejected your cert for 2-way PKI authentication</div></td><td class=""><div class="softmerge-inner" style="left: -1px;">Run the following commands to get info:<br>Server CA list: <span style="font-family:Consolas,Arial;">openssl s_client -connect remoteserver:443</span><br>                     (Look for "Acceptible cliend certificate CA names")<br>Client Cert CA (PEM w/chain): <span style="font-family:Consolas,Arial;">openssl x509 -in my.pem -text</span><br>                     (Look for "Issuer")<br>Then check:<br>1) Ensure that the server accepts a cert signed by your cert's CA<br>2) Ensure that your cert is within the validity dates<br>3) Ensure that reverse DNS matches your cert's CN</div></td></tr><tr class=""><td class="">Java</td><td class=""><div class="softmerge-inner" style="left: -1px;">javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: <br>PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException:<br>unable to find valid certification path to requested target</div></td><td class="">Your client cannot verify the server's certificate.</td><td class=""><div class="softmerge-inner" style="left: -1px;">Disable certificate verification features (not recommended!)<br>OR<br>1) Find the truststore for your application and make sure it's loaded.<br>This varies based on the application, but often involves the JVM setting javax.net.ssl.truststore - look in config files or use jvisualvm.<br>This will be a JKS or P12 store.<br>2) Pull the cert from the server<br><span style="font-family:Consolas,Arial;">openssl s_client -connect </span><span style="font-family:Consolas,Arial;font-weight:bold;">remoteserver:443</span><span style="font-family:Consolas,Arial;"> 2&gt;&amp;1 | sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' &gt; </span><span style="font-family:Consolas,Arial;font-weight:bold;">server_cert.pem</span><br>3) Check the dates<br><span style="font-family:Consolas,Arial;">openssl x509 -noout -in </span><span style="font-family:Consolas,Arial;font-weight:bold;">server_cert.pem</span><span style="font-family:Consolas,Arial;"> -subject -dates</span><br>4) Check the subject <br><span style="font-family:Consolas,Arial;">openssl x509 -noout -in </span><span style="font-family:Consolas,Arial;font-weight:bold;">server_cert.pem</span><span style="font-family:Consolas,Arial;"> -subject</span><br>vs.<br><span style="font-family:Consolas,Arial;">nslookup </span><span style="font-family:Consolas,Arial;font-weight:bold;">remoteserver<br></span><span style="font-family:Consolas,Arial;">nslookup </span><span style="font-family:Consolas,Arial;font-weight:bold;">ip_addr_from_last_command</span><br>5) Check that the issuer is in your truststore<br><span style="font-family:Consolas,Arial;">openssl x509 -noout -in </span><span style="font-family:Consolas,Arial;font-weight:bold;">server_cert.pem</span><span style="font-family:Consolas,Arial;"> -issuer<br></span>vs.<br><span style="font-family:Consolas,Arial;">keytool -list -v -keystore </span><span style="font-family:Consolas,Arial;font-weight:bold;">truststore.p12</span><span style="font-family:Consolas,Arial;"> | grep "</span><span style="font-family:Consolas,Arial;font-weight:bold;">CN OF THE ISSUER</span><span style="font-family:Consolas,Arial;">"</span></div></td></tr></tbody></table></section><section id="Socket-Encryption Standard"><h3>Socket Encryption Standard</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Identifier</th><th>Algorithm Name</th><th>Notes</th><th>Generally Secure of 2019-06-29</th><th>Wikipedia</th></tr></thead><tbody><tr class=""><td class="">SSL</td><td class="">Secure Sockets Layer</td><td class=""></td><td class="">No</td><td class="" rowspan="8"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">https://en.wikipedia.org/wiki/Transport_Layer_Security</a></td></tr><tr class=""><td class="">SSLv2</td><td class="">Secure Sockets Layer v2</td><td class=""></td><td class="">No</td></tr><tr class=""><td class="">SSLv3</td><td class="">Secure Sockets Layer v3</td><td class=""></td><td class="">No</td></tr><tr class=""><td class="">TLS</td><td class="">Transport Layer Security</td><td class=""></td><td class="">No, as it allows 1.0/1.1</td></tr><tr class=""><td class="">TLS1.0</td><td class="">Transport Layer Security v1.0</td><td class=""></td><td class="">No</td></tr><tr class=""><td class="">TLS1.1</td><td class="">Transport Layer Security v1.1</td><td class=""></td><td class="">No, as no secure ciphers are guaranteed</td></tr><tr class=""><td class="">TLS1.2</td><td class="">Transport Layer Security v1.2</td><td class=""></td><td class="">Yes</td></tr><tr class=""><td class="">TLS1.3</td><td class="">Transport Layer Security v1.3</td><td class=""></td><td class="">Yes</td></tr></tbody></table></section><section id="Key-Usages"><h3>Key Usages</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th><div class="softmerge-inner" style="left: -1px;">Key Usage Extension</div></th><th>Value</th><th>RFC 5280 Defintion</th><th>Meaning</th><th>Example</th></tr></thead><tbody><tr class=""><td class="">Digital Signature</td><td class="">0</td><td class="">The digitalSignature bit is asserted when the subject public key<br>      is used for verifying digital signatures, other than signatures on<br>      certificates (bit 5) and CRLs (bit 6), such as those used in an<br>      entity authentication service, a data origin authentication<br>      service, and/or an integrity service.</td><td class=""></td><td class="">- TLS/SSL Client (Browser, Email App)<br>- S/MIME Signing (Sign Email Encoding)<br>- Object Signing</td></tr><tr class=""><td class="">Non-Repudiation</td><td class="">1</td><td class="">The nonRepudiation bit is asserted when the subject public key is<br>      used to verify digital signatures, other than signatures on<br>      certificates (bit 5) and CRLs (bit 6), used to provide a non-<br>      repudiation service that protects against the signing entity<br>      falsely denying some action.  In the case of later conflict, a<br>      reliable third party may determine the authenticity of the signed<br>      data.  (Note that recent editions of X.509 have renamed the<br>      nonRepudiation bit to contentCommitment.)</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">Key Encipherment</td><td class="">2</td><td class="">The keyEncipherment bit is asserted when the subject public key is<br>      used for enciphering private or secret keys, i.e., for key<br>      transport.  For example, this bit shall be set when an RSA public<br>      key is to be used for encrypting a symmetric content-decryption<br>      key or an asymmetric private key.</td><td class=""></td><td class="">Assigned PKIS used for generation session keys for:<br>- TLS/SSL Server (Web Server, Reverse Proxy)<br>- S/MIME Encryption (Mail Server)</td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">Data Encipherment</div></td><td class="">3</td><td class="">The dataEncipherment bit is asserted when the subject public key<br>      is used for directly enciphering raw user data without the use of<br>      an intermediate symmetric cipher.  Note that the use of this bit<br>      is extremely uncommon; almost all applications use key transport<br>      or key agreement to establish a symmetric key.</td><td class=""></td><td class="">Rarely used outside of session keys.</td></tr><tr class=""><td class="">Key Agreement</td><td class="">4</td><td class="">The keyAgreement bit is asserted when the subject public key is<br>      used for key agreement.  For example, when a Diffie-Hellman key is<br>      to be used for key management, then this bit is set.</td><td class=""></td><td class=""></td></tr><tr class=""><td class="">Certificate Signing</td><td class="">5</td><td class="">The keyCertSign bit is asserted when the subject public key is<br>      used for verifying signatures on public key certificates.  If the<br>      keyCertSign bit is asserted, then the cA bit in the basic<br>      constraints extension (Section 4.2.1.9) MUST also be asserted.</td><td class="">Used to verify that a specific certificate was signed by a specific Certificate Authority.</td><td class="">- A CA would use their highly secured keypair when responding to the certificate request, generating a key that is provably signed by that CA</td></tr><tr class=""><td class="">CRL Signing</td><td class="">6</td><td class="">The cRLSign bit is asserted when the subject public key is used<br>      for verifying signatures on certificate revocation lists (e.g.,<br>      CRLs, delta CRLs, or ARLs).</td><td class="">Used to verify a Certifificate Revocation List from a Certificate Authority</td><td class="">- A CA revoking a specific certifcate (due to customer expiry/contract break/etc.) or intermediary (due to compromise concern) so that it would fail verification.</td></tr><tr class=""><td class="">Encipher Only</td><td class="">7</td><td class="">The meaning of the encipherOnly bit is undefined in the absence of<br>      the keyAgreement bit.  When the encipherOnly bit is asserted and<br>      the keyAgreement bit is also set, the subject public key may be<br>      used only for enciphering data while performing key agreement.</td><td class="">Modifier bit for keyAgreement limiting the public key to only encrypting data.</td><td class=""></td></tr><tr class=""><td class="">Decipher Only</td><td class="">8</td><td class="">The meaning of the decipherOnly bit is undefined in the absence of<br>      the keyAgreement bit.  When the decipherOnly bit is asserted and<br>      the keyAgreement bit is also set, the subject public key may be<br>      used only for deciphering data while performing key agreement.</td><td class="">Modifier bit for keyAgreement limiting the public key to only decrypting data.</td><td class=""></td></tr></tbody></table></section><section id="Common-Attacks"><h3>Common Attacks</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Attack</th><th>Scope</th><th>Year</th><th>Summary</th><th>Link</th></tr></thead><tbody><tr class=""><td class="">Renegotiation attack</td><td class="">Protocol</td><td class="">2009</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">FREAK</td><td class="">Protocol</td><td class="">2015</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/FREAK">https://en.wikipedia.org/wiki/FREAK</a></td></tr><tr class=""><td class="">Logjam</td><td class="">Protocol</td><td class="">2015</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Logjam_(computer_security)">https://en.wikipedia.org/wiki/Logjam_(computer_security)</a></td></tr><tr class=""><td class="">Drown</td><td class="">Protocol</td><td class="">2016</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/DROWN_attack">https://en.wikipedia.org/wiki/DROWN_attack</a></td></tr><tr class=""><td class="">BEAST</td><td class="">Protocol</td><td class="">2011</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">CRIME</td><td class="">Protocol</td><td class="">2012</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/CRIME">https://en.wikipedia.org/wiki/CRIME</a></td></tr><tr class=""><td class="">BREACH</td><td class="">Protocol</td><td class="">2013</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/BREACH">https://en.wikipedia.org/wiki/BREACH</a></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">Timing Attacks on Padding</div></td><td class="">Protocol</td><td class="">2002</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">Lucky Thirteen attack</td><td class="">Protocol</td><td class="">2013</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">POODLE</td><td class="">Protocol</td><td class="">2014</td><td class=""></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/POODLE">https://en.wikipedia.org/wiki/POODLE</a></td></tr><tr class=""><td class="">RC4 Attack</td><td class="">Protocol</td><td class="">2013</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">Truncation attack</td><td class="">Protocol</td><td class="">2013</td><td class=""></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">Unholy PAC attack</td><td class="">Protocol</td><td class="">2016</td><td class="">Bug in proxy discovery protocol causes URL leakage.</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class=""><a target="_blank" href="https://sweet32.info/">Sweet32 attack</a></td><td class="">Protocol</td><td class="">2016</td><td class=""><div class="softmerge-inner" style="left: -1px;">Birthday Attack on 64-bit CBC ciphers via MITM/Injection.</div></td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL">https://en.wikipedia.org/wiki/Transport_Layer_Security#Attacks_against_TLS/SSL</a></div></td></tr><tr class=""><td class="">Heartbleed</td><td class=""><div class="softmerge-inner" style="left: -1px;">Implementation</div></td><td class="">2014</td><td class="">OpenSSL memory issue allows private key leakage.</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Heartbleed">https://en.wikipedia.org/wiki/Heartbleed</a></td></tr><tr class=""><td class="">Cloudbleed</td><td class=""><div class="softmerge-inner" style="left: -1px;">Implementation</div></td><td class="">2017</td><td class=""><div class="softmerge-inner" style="left: -1px;">Cloudflare bug caused reverse proxies to leak secret info.</div></td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Cloudbleed">https://en.wikipedia.org/wiki/Cloudbleed</a></td></tr></tbody></table></section><section id="Which-Should I Use"><h3>Which Should I Use</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Key/Cert File Format</th><th></th></tr></thead><tbody><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">You usually don't get to choose arbitrarily&nbsp;- applications typically offer support for a limited number of formats!</div></td><td class=""></td></tr><tr class=""><td class="">App</td><td class="">Type</td></tr><tr class=""><td class=""><a target="_blank" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html">Java apps (Apache, Tomcat, etc.) using JSSE</a></td><td class="">P12 unless you MUST use JKS!</td></tr><tr class=""><td class=""><a target="_blank" href="http://curl.haxx.se/docs/manpage.html">CURL</a></td><td class="">PEM or DER</td></tr><tr class=""><td class="">Firefox</td><td class="">P12, PEM, DER, P7B</td></tr><tr class=""><td class="">IE and Windows</td><td class="">P12, DER, P7B</td></tr><tr class=""><td class="">Chrome</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" href="https://www.gnu.org/software/wget/manual/html_node/HTTPS-_0028SSL_002fTLS_0029-Options.html">WGet</a></td><td class="">PEM or DER</td></tr><tr class=""><td class="">IIS</td><td class=""></td></tr><tr class=""><td class=""><a target="_blank" href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl">NGinx</a></td><td class="">PEM</td></tr><tr class=""><td class=""><a target="_blank" href="https://nodejs.org/api/https.html">Node.JS</a></td><td class="">PEM</td></tr><tr class=""><td class=""></td><td class=""></td></tr><tr class=""><td class="">But, if you get to choose:</td><td class=""></td></tr><tr class=""><td class="">Goal</td><td class="">Format</td></tr><tr class=""><td class="">Portability</td><td class="">P12 or PEM</td></tr><tr class=""><td class="">Edit/Merge by hand</td><td class="">PEM</td></tr><tr class=""><td class="">Size</td><td class="">DER</td></tr></tbody></table></section><section id="References-Links"><h3>References Links</h3><table class="" cellspacing="0" cellpadding="0"><thead><tr><th>Description</th><th>URL</th></tr></thead><tbody><tr class=""><td class="">Stack Overflow - PEMs vs. Keys</td><td class=""><a target="_blank" href="http://serverfault.com/questions/9708/what-is-a-pem-file-and-how-does-it-differ-from-other-openssl-generated-key-file">http://serverfault.com/questions/9708/what-is-a-pem-file-and-how-does-it-differ-from-other-openssl-generated-key-file</a></td></tr><tr class=""><td class="">Common OpenSSL Commands</td><td class=""><a target="_blank" href="https://www.sslshopper.com/article-most-common-openssl-commands.html">https://www.sslshopper.com/article-most-common-openssl-commands.html</a></td></tr><tr class=""><td class="">Online Key Converter <span style="font-weight:bold;">(DO NOT USE!)</span></td><td class=""><a target="_blank" href="https://www.sslshopper.com/ssl-converter.html">https://www.sslshopper.com/ssl-converter.html</a></td></tr><tr class=""><td class="">Common Java Keytool Commands</td><td class=""><a target="_blank" href="https://www.sslshopper.com/article-most-common-java-keytool-keystore-commands.html">https://www.sslshopper.com/article-most-common-java-keytool-keystore-commands.html</a></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">Cert usage ref: Java apps (Apache, Tomcat, etc.) using JSSE</div></td><td class=""><a target="_blank" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html">https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html</a></td></tr><tr class=""><td class="">Cert usage ref: CURL</td><td class=""><a target="_blank" href="http://curl.haxx.se/docs/manpage.html">http://curl.haxx.se/docs/manpage.html</a></td></tr><tr class=""><td class="">Cert usage ref:&nbsp;WGet</td><td class=""><a target="_blank" href="https://www.gnu.org/software/wget/manual/html_node/HTTPS-_0028SSL_002fTLS_0029-Options.html">https://www.gnu.org/software/wget/manual/html_node/HTTPS-_0028SSL_002fTLS_0029-Options.html</a></td></tr><tr class=""><td class="">Cert usage ref: NGinx</td><td class=""><a target="_blank" href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl">http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl</a></td></tr><tr class=""><td class="">Cert usage ref: Node.JS</td><td class=""><a target="_blank" href="https://nodejs.org/api/https.html">https://nodejs.org/api/https.html</a></td></tr><tr class=""><td class="">Official OpenSSL Command Reference</td><td class=""><a target="_blank" href="https://wiki.openssl.org/index.php/Command_Line_Utilities">https://wiki.openssl.org/index.php/Command_Line_Utilities</a></td></tr><tr class=""><td class="">Verifying a Key and Cert PEM pair</td><td class=""><a target="_blank" href="https://kb.wisc.edu/middleware/page.php?id=4064">https://kb.wisc.edu/middleware/page.php?id=4064</a></td></tr><tr class=""><td class="">Creating a public key PEM</td><td class=""><a target="_blank" href="http://stackoverflow.com/questions/17143606/how-to-save-public-key-from-a-certificate-in-pem-format">http://stackoverflow.com/questions/17143606/how-to-save-public-key-from-a-certificate-in-pem-format</a></td></tr><tr class=""><td class=""><div class="softmerge-inner" style="left: -1px;">StackOverflow on Securing getting passwords in a batch file </div></td><td class=""><a target="_blank" href="http://stackoverflow.com/questions/664957/can-i-mask-an-input-text-in-a-bat-file">http://stackoverflow.com/questions/664957/can-i-mask-an-input-text-in-a-bat-file</a></td></tr><tr class=""><td class="">MSDN Blog on SecureString conversion concerns</td><td class=""><a target="_blank" href="http://blogs.msdn.com/b/fpintos/archive/2009/06/12/how-to-properly-convert-securestring-to-string.aspx">http://blogs.msdn.com/b/fpintos/archive/2009/06/12/how-to-properly-convert-securestring-to-string.aspx</a></td></tr><tr class=""><td class="">Generic RSA Form for OpenSSL</td><td class=""><a target="_blank" href="https://en.wikibooks.org/wiki/Cryptography/Generate_a_keypair_using_OpenSSL">https://en.wikibooks.org/wiki/Cryptography/Generate_a_keypair_using_OpenSSL</a></td></tr><tr class=""><td class="">Passin/Passout Usage</td><td class=""><a target="_blank" href="http://stackoverflow.com/questions/4294689/how-to-generate-a-key-with-passphrase-from-the-command-line">http://stackoverflow.com/questions/4294689/how-to-generate-a-key-with-passphrase-from-the-command-line</a></td></tr><tr class=""><td class="">AWK Script to split PEM</td><td class=""><a target="_blank" href="https://gist.github.com/jinnko/d6867ce326e8b6e88975">https://gist.github.com/jinnko/d6867ce326e8b6e88975</a></td></tr><tr class=""><td class="">Asking a server what the CA list is</td><td class=""><a target="_blank" href="https://stackoverflow.com/questions/8484360/ssl-bad-certificate-error">https://stackoverflow.com/questions/8484360/ssl-bad-certificate-error</a></td></tr><tr class=""><td class="">Pull cert from a server</td><td class=""><a target="_blank" href="https://www.madboa.com/geek/openssl/#cert-retrieve">https://www.madboa.com/geek/openssl/#cert-retrieve</a></td></tr><tr class=""><td class="">Bash pw prompt</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://unix.stackexchange.com/questions/232063/what-is-most-secure-and-simplest-way-to-have-a-user-typed-password-on-bash-becom">https://unix.stackexchange.com/questions/232063/what-is-most-secure-and-simplest-way-to-have-a-user-typed-password-on-bash-becom</a></div></td></tr><tr class=""><td class="">Checking certs against server</td><td class=""><a target="_blank" href="https://langui.sh/2009/03/14/checking-a-remote-certificate-chain-with-openssl/">https://langui.sh/2009/03/14/checking-a-remote-certificate-chain-with-openssl/</a></td></tr><tr class=""><td class="">Full fledged pems to p12</td><td class=""><a target="_blank" href="https://serverfault.com/questions/483465/import-of-pem-certificate-chain-and-key-to-java-keystore">https://serverfault.com/questions/483465/import-of-pem-certificate-chain-and-key-to-java-keystore</a></td></tr><tr class=""><td class="">Key Usages</td><td class=""><div class="softmerge-inner" style="left: -1px;"><a target="_blank" href="https://www.ibm.com/support/knowledgecenter/en/SSKTMJ_9.0.1/admin/conf_keyusageextensionsandextendedkeyusage_r.html">https://www.ibm.com/support/knowledgecenter/en/SSKTMJ_9.0.1/admin/conf_keyusageextensionsandextendedkeyusage_r.html</a></div></td></tr><tr class=""><td class="">Key Usage in X509 v3 spec</td><td class=""><a target="_blank" href="https://tools.ietf.org/html/rfc5280#section-4.2.1">https://tools.ietf.org/html/rfc5280#section-4.2.1</a></td></tr><tr class=""><td class="">TLS</td><td class=""><a target="_blank" href="https://en.wikipedia.org/wiki/Transport_Layer_Security">https://en.wikipedia.org/wiki/Transport_Layer_Security</a></td></tr><tr class=""><td class="">OpenSSL Digest Mode Public Key Issue</td><td class=""><a target="_blank" href="https://stackoverflow.com/questions/2385320/verifying-a-file-signature-with-openssl-dgst">https://stackoverflow.com/questions/2385320/verifying-a-file-signature-with-openssl-dgst</a></td></tr><tr class=""><td class="">OpenSSL and Curl OCSP</td><td class=""><a target="_blank" href="https://gist.github.com/vanbroup/ca7d52a1a6006b5ba03b43d891384ed1">https://gist.github.com/vanbroup/ca7d52a1a6006b5ba03b43d891384ed1</a></td></tr><tr class=""><td class="">PuttyGen CLI Conversion</td><td class=""><a target="_blank" href="https://aws.amazon.com/premiumsupport/knowledge-center/convert-pem-file-into-ppk/">https://aws.amazon.com/premiumsupport/knowledge-center/convert-pem-file-into-ppk/</a></td></tr></tbody></table></section></article></main>
    </div>


</body></html>